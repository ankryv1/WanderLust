<% layout("/layouts/boilerplate") %>

<div class="row offset-2">
  <div class="col-6">
    <h1><%= nag.title %></h1>
    <div class="card show-card listing-card">
      <img
        src="<%=nag.image.url%>"
        class="card-img-top show-img"
        alt="listing-image"
      />
      <br />
<div class="card-body">
  <p class="card-text">
    ğŸ‘¤ <strong>Owned by:</strong> <%= nag.owner.username %>
  </p>

  <p class="card-text">
    ğŸ“ <strong>Description:</strong> <%= nag.description %>
  </p>

  <p class="card-text">
    ğŸŒ <strong>Country:</strong> <%= nag.country %>
  </p>

  <p class="card-text">
    ğŸ’° <strong>Price:</strong> &#8377;<%= nag.price.toLocaleString("en-IN") %>
  </p>

  <p class="card-text">
    ğŸ“ <strong>Location:</strong> <%= nag.location %>
  </p>
</div>

    </div>
  </div>

  <% if(currUser && currUser._id.equals(nag.owner._id)) {%>
  <div class="btns">
    <form action="/listings/<%= nag._id %>/edit" method="get">
      <button class="btn offset-2 edit-btn btn-dark">Edit</button>
    </form>

    <form action="/listings/<%= nag._id %>?_method=DELETE" method="post">
      <button class="btn offset-4 delete-b">delete</button>
    </form>
  </div>
  <% } %>
  <div>
    
    <hr />

    <h4>Leave a review</h4>
    <form
      action="/listings/<%= nag._id %>/reviews"
      method="post"
      novalidate
      class="needs-validation my-2"
    >
        <div class="">
        <label for="rating" class="form-label">Rating</label>
        <fieldset class="starability-slot">
            
          <input
            type="radio"
            id="no-rate"
            class="input-no-rate"
            name="rating"
            value="1"
            checked
            aria-label="No rating."
          />
          <input type="radio" id="first-rate1" name="rating" value="1" />
          <label for="first-rate1" title="Terrible">1 star</label>
          <input type="radio" id="first-rate2" name="rating" value="2" />
          <label for="first-rate2" title="Not good">2 stars</label>
          <input type="radio" id="first-rate3" name="rating" value="3" />
          <label for="first-rate3" title="Average">3 stars</label>
          <input type="radio" id="first-rate4" name="rating" value="4" />
          <label for="first-rate4" title="Very good">4 stars</label>
          <input type="radio" id="first-rate5" name="rating" value="5" />
          <label for="first-rate5" title="Amazing">5 stars</label>
        </fieldset>
        </div>
        <div>
          <label for="comment" class="form-label">Comment</label>
          <textarea
            name="comment"
            id="comment"
            cols="30"
            rows="5"
            class="form-control"
            required
            minlength="5"
          ></textarea>
          <div class="invalid-feedback">Please add something for review</div>
        </div>
        <br />
        <button class="btn btn-outline-dark">Submit</button>
      </div>
    </form>

    <% if(nag.review.length) { %>
    <h4>All Reviews</h4>
    <div class="row">
      <% for(let rev of nag.review) { %>
      <div class="card col-5 mb-3 ms-3">
        <div class="card-body">
          <h5 class="card-title"><%= rev.author.username %></h5>
          <p class="card-text"><%= rev.comment %></p>
          <p class="starability-result  card-text" data-rating="<%= rev.rating %>">Rated: 3 stars</p>
          <form
            action="/listings/<%= nag._id %>/reviews/<%= rev._id %>?_method=DELETE"
            method="POST"
            class="my-2"
          >
            <button class="btn btn-dark">Delete</button>
          </form>
        </div>
      </div>
      <% } %> <% } %> <% if(!nag.review.length) { %>
      <h6>No Reviews Yet, Be the first to Review it</h6>
      <% } %>
    </div>
  </div>
</div>
